---
# Install all the CLI Geoscripting software on Ubuntu-like OSs.

tasks:
- name: Install R and its package dependencies
    apt:
        pkg:
        - r-base
        - r-base-dev
        - libgdal-dev
        - libgeos-dev
        - libproj-dev
        - libxml2-dev
        - libcurl4-openssl-dev
        - libssl-dev
        - libudunits2-dev
        - liblwgeom-dev
        - gdebi-core

- name: Install PostGIS
    apt:
        pkg:
        - postgis
        - pgadmin3
        - postgresql-contrib
        - postgresql-server-dev-12

- name: Add geoscripting user to postgresql
  community.general.postgresql_user:
    name: geoscripting
    password: geoscripting
    role_attr_flags: CREATEDB,NOSUPERUSER

- name: Add new postgresql DB
  community.general.postgresql_db:
    name: geoscripting

- name: Enable PostGIS
  community.general.postgresql_ext:
    name: postgis
    db: geoscripting

